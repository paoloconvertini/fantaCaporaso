<div class="rosters-container" *ngIf="!loading; else loadingTpl">

    <table class="rosters-table">
        <thead>
        <tr>
            <th>#</th>
            <th *ngFor="let p of participants">{{ p.name }}</th>
        </tr>
        </thead>

        <tbody>
        <ng-container *ngFor="let role of rolesOrder">

            <!-- filtro fatto con ng-container + ngFor -->
            <ng-container *ngFor="let row of tableByRole(role)">
                <tr [class.totals-row]="row.index === 'TOT'" [class]="'role-' + role.toLowerCase()">
                    <td class="role-index">
                        <span *ngIf="row.index !== 'TOT'">{{ row.index }}</span>
                        <strong *ngIf="row.index === 'TOT'">Tot {{ role }}</strong>
                    </td>
                    <td *ngFor="let p of participants" class="player-cell">
                        <ng-container *ngIf="row.players[p.id] as player">
            <span *ngIf="row.index !== 'TOT'">
              {{ player.playerName }} <small>({{ player.amount }})</small>
            </span>

                            <strong *ngIf="row.index === 'TOT'">{{ player.amount }}</strong>
                        </ng-container>
                    </td>
                </tr>
            </ng-container>

            <!-- separatore visivo -->
            <tr class="role-separator">
                <td [attr.colspan]="participants.length + 1"></td>
            </tr>

        </ng-container>
        </tbody>

    </table>

</div>

<ng-template #loadingTpl>
    <div class="loading-overlay">
        <mat-spinner diameter="48"></mat-spinner>
        <p>Caricamento rose...</p>
    </div>
</ng-template>
